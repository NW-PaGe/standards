<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Frank Aragona">
<meta name="dcterms.date" content="2023-02-01">
<meta name="description" content="How to configure R and Python package dependencies for reproducibility">

<title>Virtual Environments – NW-COE Policies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4463693438d44bc4a6ba82d70edba7d0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-71f2824f185f7f241352d6490053fe7d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/bootstrap-icons-1.11.1/all.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/nwpage_tree_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">NW-COE Policies</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../gh/index.html" aria-current="page"> 
<span class="menu-text">Github</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../aws/aws_index.html"> 
<span class="menu-text">AWS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../azure/azure_index.html"> 
<span class="menu-text">Azure</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/NW-PaGe/standards"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://nwpage.org/"> <i class="bi bi-file-richtext" role="img" aria-label="NW-PaGe">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/NW-PaGe/standards/blob/main/nw-page-policies.pdf"> <i class="bi bi-file-earmark-pdf-fill" role="img" aria-label="NW-PaGe PDF">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../gh/index.html">Github</a></li><li class="breadcrumb-item"><a href="../gh/release.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../gh/renv.html">Virtual Environments</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../gh/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Github</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Policies</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/quickstart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/security.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repo Security</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/gh_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git/GitHub User Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/gh_collab_tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collaborating on GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/policies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Org Policies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/lic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Licensing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/reproduce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducibility</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/release.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Release Cycles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/renv.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Virtual Environments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/templates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Templates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/how_to.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repo Documentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gh/newrepo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">New Repo</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><strong>Summary</strong><i class="bi-file-earmark-check-fill " style="" role="img" aria-hidden="true"></i></a></li>
  <li><a href="#intro" id="toc-intro" class="nav-link" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#venv" id="toc-venv" class="nav-link" data-scroll-target="#venv">venv</a>
  <ul>
  <li><a href="#create-a-venv" id="toc-create-a-venv" class="nav-link" data-scroll-target="#create-a-venv">create a venv</a>
  <ul class="collapse">
  <li><a href="#step-1---workspaces" id="toc-step-1---workspaces" class="nav-link" data-scroll-target="#step-1---workspaces">step 1 - Workspaces</a></li>
  <li><a href="#step-2---install-uv" id="toc-step-2---install-uv" class="nav-link" data-scroll-target="#step-2---install-uv">step 2 - install uv</a></li>
  <li><a href="#step-3---create-venv" id="toc-step-3---create-venv" class="nav-link" data-scroll-target="#step-3---create-venv">step 3 - create venv</a></li>
  <li><a href="#step-4---activate-venv" id="toc-step-4---activate-venv" class="nav-link" data-scroll-target="#step-4---activate-venv">step 4 - activate venv</a></li>
  <li><a href="#step-5---add-packages" id="toc-step-5---add-packages" class="nav-link" data-scroll-target="#step-5---add-packages">step 5 - add packages</a></li>
  </ul></li>
  <li><a href="#ide-configurations" id="toc-ide-configurations" class="nav-link" data-scroll-target="#ide-configurations">IDE configurations</a></li>
  </ul></li>
  <li><a href="#conda" id="toc-conda" class="nav-link" data-scroll-target="#conda">conda</a>
  <ul>
  <li><a href="#create-conda-env" id="toc-create-conda-env" class="nav-link" data-scroll-target="#create-conda-env">create conda env</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-anaconda" id="toc-step-1-set-up-anaconda" class="nav-link" data-scroll-target="#step-1-set-up-anaconda">Step 1: Set Up Anaconda</a></li>
  <li><a href="#step-2-open-anaconda-prompt" id="toc-step-2-open-anaconda-prompt" class="nav-link" data-scroll-target="#step-2-open-anaconda-prompt">Step 2: Open Anaconda Prompt</a></li>
  <li><a href="#step-3-change-directories" id="toc-step-3-change-directories" class="nav-link" data-scroll-target="#step-3-change-directories">Step 3: Change Directories</a></li>
  <li><a href="#step-4-copy-the-repo-env" id="toc-step-4-copy-the-repo-env" class="nav-link" data-scroll-target="#step-4-copy-the-repo-env">Step 4: Copy the repo env</a></li>
  <li><a href="#step-5-activate-the-environment" id="toc-step-5-activate-the-environment" class="nav-link" data-scroll-target="#step-5-activate-the-environment">Step 5: Activate the environment</a></li>
  </ul></li>
  <li><a href="#install-new-packages" id="toc-install-new-packages" class="nav-link" data-scroll-target="#install-new-packages">install new packages</a>
  <ul class="collapse">
  <li><a href="#step-1-install-a-new-package" id="toc-step-1-install-a-new-package" class="nav-link" data-scroll-target="#step-1-install-a-new-package">Step 1: Install a new package</a></li>
  <li><a href="#step-2-save-the-package-to-the-repo" id="toc-step-2-save-the-package-to-the-repo" class="nav-link" data-scroll-target="#step-2-save-the-package-to-the-repo">Step 2: Save the package to the repo</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#renv" id="toc-renv" class="nav-link" data-scroll-target="#renv">renv</a>
  <ul>
  <li><a href="#create-a-renv" id="toc-create-a-renv" class="nav-link" data-scroll-target="#create-a-renv">create a renv</a>
  <ul class="collapse">
  <li><a href="#step-1---workspaces-1" id="toc-step-1---workspaces-1" class="nav-link" data-scroll-target="#step-1---workspaces-1">step 1 - workspaces</a></li>
  <li><a href="#step-2---install-renv" id="toc-step-2---install-renv" class="nav-link" data-scroll-target="#step-2---install-renv">step 2 - install renv</a></li>
  <li><a href="#step-3---initialize-renv" id="toc-step-3---initialize-renv" class="nav-link" data-scroll-target="#step-3---initialize-renv">step 3 - initialize renv</a></li>
  <li><a href="#step-4---activate-renv" id="toc-step-4---activate-renv" class="nav-link" data-scroll-target="#step-4---activate-renv">step 4 - activate renv</a></li>
  <li><a href="#step-5---add-packages-1" id="toc-step-5---add-packages-1" class="nav-link" data-scroll-target="#step-5---add-packages-1">step 5 - add packages</a></li>
  <li><a href="#step-6---save-package-updates" id="toc-step-6---save-package-updates" class="nav-link" data-scroll-target="#step-6---save-package-updates">step 6 - save package updates</a></li>
  <li><a href="#step-7---push-to-github" id="toc-step-7---push-to-github" class="nav-link" data-scroll-target="#step-7---push-to-github">step 7 - push to GitHub</a></li>
  <li><a href="#troubleshooting" id="toc-troubleshooting" class="nav-link" data-scroll-target="#troubleshooting">troubleshooting</a></li>
  </ul></li>
  <li><a href="#load-renv" id="toc-load-renv" class="nav-link" data-scroll-target="#load-renv">load renv</a>
  <ul class="collapse">
  <li><a href="#step-1---open-your-workspace" id="toc-step-1---open-your-workspace" class="nav-link" data-scroll-target="#step-1---open-your-workspace">step 1 - open your workspace</a></li>
  <li><a href="#step-2---restore-renv" id="toc-step-2---restore-renv" class="nav-link" data-scroll-target="#step-2---restore-renv">step 2 - restore renv</a></li>
  </ul></li>
  <li><a href="#using-reticulate-python-with-renv" id="toc-using-reticulate-python-with-renv" class="nav-link" data-scroll-target="#using-reticulate-python-with-renv">using reticulate (python) with renv</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/NW-PaGe/standards/blob/main/gh/renv.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/NW-PaGe/standards/edit/main/gh/renv.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/NW-PaGe/standards/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../gh/index.html">Github</a></li><li class="breadcrumb-item"><a href="../gh/release.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../gh/renv.html">Virtual Environments</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Virtual Environments</h1>
</div>

<div>
  <div class="description">
    How to configure R and Python package dependencies for reproducibility
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Frank Aragona </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 1, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 10, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="summary" class="level2 box">
<h2 class="anchored" data-anchor-id="summary"><strong>Summary</strong><i class="bi-file-earmark-check-fill " style="" role="img" aria-hidden="true"></i></h2>
<ul>
<li>Virtual environments are self-contained, isolated workspaces</li>
<li>They allow you to manage project-specific dependencies</li>
<li>They help to avoid conflicts between different projects</li>
</ul>
<p>This doc will go over how to create and manage:</p>
<ul>
<li><strong>venv:</strong> the most common python virtual environment module</li>
<li><strong>conda:</strong> the hellscape of virtual environments that can be used with both Python and R (i don’t recommend unless you need it)</li>
<li><strong>renv:</strong> the most commonly used virtual environment package for R (can be mixed with venv and/or conda for bilingual R/Python repos)</li>
</ul>
</section>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>A virtual environment is a self-contained, isolated workspace that allows you to manage project-specific dependencies and avoid conflicts between different projects. Virtual environments allow us to execute code while accounting for software/package version differences we have on our local machines. This repo uses virtual environments to configure a user’s R and Python software and packages to the repo’s specific package versions.</p>
<p>For example, say you have dplyr version <code>2.0</code> but this repo uses dplyr version <code>1.1</code>, you may not be able to run the scripts as intended by the author since the functions in dplyr <code>1.1</code> may be different than in <code>2.0</code>. The virtual environment will allow a given user to use only this repo’s version of dplyr so they can run the code as intended.</p>
</section>
<section id="venv" class="level2">
<h2 class="anchored" data-anchor-id="venv">venv</h2>
<p><code>venv</code> is a module for creating virtual python environments. From the <a href="https://docs.python.org/3/library/venv.html">python venv docs</a>:</p>
<blockquote class="blockquote">
<p>The venv module supports creating lightweight “virtual environments”, each with their own independent set of Python packages installed in their site directories.</p>
</blockquote>
<blockquote class="blockquote">
<p>A virtual environment is (amongst other things):</p>
</blockquote>
<blockquote class="blockquote">
<ul>
<li>Used to contain a specific Python interpreter and software libraries and binaries which are needed to support a project (library or application). These are by default isolated from software in other virtual environments and Python interpreters and libraries installed in the operating system.</li>
<li>Contained in a directory, conventionally named .venv or venv in the project directory, or under a container directory for lots of virtual environments, such as <code>~/.virtualenvs</code>.</li>
<li>Not checked into source control systems such as Git.</li>
<li>Considered as disposable – it should be simple to delete and recreate it from scratch. You don’t place any project code in the environment.</li>
<li>Not considered as movable or copyable – you just recreate the same environment in the target location.</li>
</ul>
</blockquote>
<p>To create a venv in Python we can do it in a terminal window. Below are instructions on how to create one with VS Code (or Positron).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>you should create a new venv for every isolated project!</p>
</div>
</div>
<section id="create-a-venv" class="level3">
<h3 class="anchored" data-anchor-id="create-a-venv">create a venv</h3>
<p>Positron has all the features of VS Code and Rstudio combined, so it’s much easier to set up for R users looking to get into Python and vice-versa.</p>
<p>Managing a venv in Positron is a bit easier than in VS Code because the UI is more user friendly for venv and renv.</p>
<section id="step-1---workspaces" class="level4">
<h4 class="anchored" data-anchor-id="step-1---workspaces">step 1 - Workspaces</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Positron</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">VS Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Open Positron and you will see a screen like this</p>
<p><img src="images/positron_main.png" class="img-fluid"></p>
<p>Assuming you already have a project folder, click <code>Open Folder</code> and navigate to the <em>root</em> of the folder you want to work in.</p>
<p>Workspaces are like isolated projects. Each isolated project needs to have its own virtual environment so that we can avoid unwanted package issues seeping into multiple projects unknowingly.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Open VS Code and you will see a screen like this</p>
<p><img src="images/vscode_main.png" class="img-fluid"></p>
<p>Assuming you already have a project folder, click <code>Open Folder</code> and navigate to the <em>root</em> of the folder you want to work in.</p>
<p>Workspaces are like isolated projects. Each isolated project needs to have its own virtual environment so that we can avoid unwanted package issues seeping into multiple projects unknowingly.</p>
</div>
</div>
</div>
</section>
<section id="step-2---install-uv" class="level4">
<h4 class="anchored" data-anchor-id="step-2---install-uv">step 2 - install uv</h4>
<p>Now you should see a terminal window with your folder in it looking like -</p>
<div class="medframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">USER@workbench-1:~/path/to/workspace/folder</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>install <a href="https://docs.astral.sh/uv/configuration/installer/">uv</a>:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-LsSf</span> https://astral.sh/uv/install.sh <span class="kw">|</span> <span class="fu">env</span> UV_INSTALL_DIR=<span class="st">"/custom/path"</span> sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="step-3---create-venv" class="level4">
<h4 class="anchored" data-anchor-id="step-3---create-venv">step 3 - create venv</h4>
<p>now run this to create a virtual environment:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> venv .venv <span class="at">--python</span><span class="op">=</span>python3.10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>this is saying create a venv named <code>.venv</code> with a specific python version (<code>3.10</code>, but it can be any version you want for this specific project):</p>
<p>you should get this message:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Using</span> CPython 3.10.12 interpreter at: /usr/bin/python3.10</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Creating</span> virtual environment at: .venv</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Activate</span> with: source .venv/bin/activate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="step-4---activate-venv" class="level4">
<h4 class="anchored" data-anchor-id="step-4---activate-venv">step 4 - activate venv</h4>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> .venv/bin/activate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>you should see this with <code>.venv</code> on the left of your username:</p>
<p><img src="images/venv_activate.png" class="img-fluid"></p>
</section>
<section id="step-5---add-packages" class="level4">
<h4 class="anchored" data-anchor-id="step-5---add-packages">step 5 - add packages</h4>
<p>Now you are in an <em>isolated</em> virtual environment called <code>.venv</code>. To add packages, run</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> pip install <span class="op">&lt;</span>PACKAGE_NAME<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>for example</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> pip install polars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>if you have a project that has existing packages in a <code>requirements.txt</code> file, you can install all of them like this:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> pip install <span class="at">-r</span> requirements.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="ide-configurations" class="level3">
<h3 class="anchored" data-anchor-id="ide-configurations">IDE configurations</h3>
<p>Now that you have your venv named <code>.venv</code>, we still need to tell Positron and VS Code that we want that venv to run our python code.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Positron</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">VS Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">PyCharm</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<section id="step-1---select-python-venv" class="level5">
<h5 class="anchored" data-anchor-id="step-1---select-python-venv">step 1 - Select Python venv</h5>
<p>Create a new python script in your folder.</p>
<p>Now in the upper right you will see a dropdown menu of Python (or R). Click it and you should see the path to the <code>.venv</code> you created in your workspace. Then click the start symbol to start that venv</p>
<p><img src="images/positron_interpreter.png" class="img-fluid"></p>
</section>
<section id="step-2---test-to-see-if-it-worked" class="level5">
<h5 class="anchored" data-anchor-id="step-2---test-to-see-if-it-worked">step 2 - test to see if it worked</h5>
<p>In your terminal, install a package that you haven’t installed before and then try to call that package in your python script. To demonstrate:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> pip install great_tables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Now write the import in your python script:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>script.py</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> great_tables <span class="im">as</span> gt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Now highlight that code in your script and press <code>CTRL + ENTER</code> and it will execute the code in your Python Console.</p>
</section>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<section id="step-1---python-select-interpreter" class="level5">
<h5 class="anchored" data-anchor-id="step-1---python-select-interpreter">step 1 - Python: Select Interpreter</h5>
<p>Create a new python script in your folder.</p>
<p>Now go to Settings &gt; Command Palette &gt; and type Python: Select Interpreter</p>
<p><img src="images/command.png" class="img-fluid"></p>
</section>
<section id="step-2---enter-interpreter" class="level5">
<h5 class="anchored" data-anchor-id="step-2---enter-interpreter">step 2 - Enter Interpreter</h5>
<p>You should see this: <img src="images/edit_interpreter.png" class="img-fluid"></p>
<p>Now to Enter your specifc interpreter, click on these options:</p>
<ul>
<li>Enter interpreter path…</li>
<li>Find…</li>
<li>.venv</li>
<li>bin</li>
<li>python3.10</li>
</ul>
<p><img src="images/edit_interpreter.gif" class="img-fluid"></p>
</section>
<section id="step-3---test-to-see-if-it-worked" class="level5">
<h5 class="anchored" data-anchor-id="step-3---test-to-see-if-it-worked">step 3 - test to see if it worked</h5>
<p>In your terminal, install a package that you haven’t installed before and then try to call that package in your python script. To demonstrate:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> pip install great_tables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Now write the import in your python script:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>script.py</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> great_tables <span class="im">as</span> gt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>and run the code in a Jupyter cell by highlighting the code &gt; right click on it &gt; Run in Interactive Window &gt; Run Selection/Line in Interactive Window</p>
<p><img src="images/line_jupyter.png" class="img-fluid"></p>
<p>It should now open a window where you can run your python code and examine your variables at once.</p>
</section>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>PyCharm also works great with a virtual environment.</p>
<section id="step-1-select-a-python-interpreter" class="level5">
<h5 class="anchored" data-anchor-id="step-1-select-a-python-interpreter">Step 1: Select a Python Interpreter</h5>
<p>You may also be able to open a PyCharm window from an Anaconda prompt like with VS Code (if it’s installed in your env). To do so, write <code>pycharm</code> in the prompt and it should open a new window with the env activated.</p>
<p>If that doesn’t work, open PyCharm and on the bottom right there is a python version and interpreter selected. Click it and open “Add New Interpreter” &gt; “Add local interpreter”. This opens a new window. Click “Conda Environment” and under “Interpreter” click the dropdown. You should be able to see your new environment there. If not, click away and click the dropdown again. It’s weird sometimes.</p>
<p>Then click okay. Close and reopen the Python Console window and it should have your environment path for the python.exe. Also, the Python Libraries window should have all of the libraries in your environment now.</p>
<p><img src="images/pycharm_int.gif" class="img-fluid"></p>
<p><br></p>
<p>Notice that now there are a list of interpreters for you to use. You can now switch back and forth between environments. This is great if you have other repos to use or want to test out new packages that aren’t in the main environment.</p>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="conda" class="level2">
<h2 class="anchored" data-anchor-id="conda">conda</h2>
<p>Repos may have a file named <code>environment.yml</code> for conda environments. It contains a list of all packages and versions used for Python software. This file can be used as a set of instructions for your local machine when configuring your local environment.</p>
<section id="create-conda-env" class="level3">
<h3 class="anchored" data-anchor-id="create-conda-env">create conda env</h3>
<section id="step-1-set-up-anaconda" class="level4">
<h4 class="anchored" data-anchor-id="step-1-set-up-anaconda">Step 1: Set Up Anaconda</h4>
<p>You should already have Anaconda installed on your machine if not..</p>
</section>
<section id="step-2-open-anaconda-prompt" class="level4">
<h4 class="anchored" data-anchor-id="step-2-open-anaconda-prompt">Step 2: Open Anaconda Prompt</h4>
<p>You may have different Anaconda prompts (prompts aligned with different shells, like PowerShell, bash, etc). There should be a generic Anaconda prompt. Open that one:</p>
<p><img src="images/open_prompt.gif" class="img-fluid"></p>
<p><br></p>
<p>If the first line in the prompt doesn’t start with <code>(base)</code>, write:</p>
<p><code>conda deactivate</code></p>
<p>and it will bring you back to your base environment.</p>
</section>
<section id="step-3-change-directories" class="level4">
<h4 class="anchored" data-anchor-id="step-3-change-directories">Step 3: Change Directories</h4>
<p>Change the directory of the prompt to the repo’s directory. The code is</p>
<p><code>cd C:/Users/XXXXXXX/Projects/Sequencing_2.0</code></p>
<p>If you are already in your user directory, you can just type</p>
<p><code>cd projects/sequencing_2.0</code></p>
<p>capitalization doesn’t matter</p>
<p><img src="images/change_directory.gif" class="img-fluid"></p>
<p><br></p>
<p>Notice that the folder path is now changed to the sequencing repo folder.</p>
</section>
<section id="step-4-copy-the-repo-env" class="level4">
<h4 class="anchored" data-anchor-id="step-4-copy-the-repo-env">Step 4: Copy the repo env</h4>
<p>Now we’re ready to create a new environment based on the repo’s environment.</p>
<p>Type: <code>conda env create --name seq_env --file=environment.yml</code></p>
<p>Note that how you name your environment doesn’t really matter, but name it something that resembles the repo. This will save the headache of having random environments for random repos that you can’t remember..</p>
<p><br></p>
<ul>
<li><code>conda env create</code> will create a new environment in your <code>C:/Users/XXXXX/Anaconda3/envs</code> file path</li>
<li><code>--name</code> or <code>-n</code> will name that environment, in this case <code>seq_env</code></li>
<li><code>--file=environment.yml</code> this code will take the file in the sequencing 2.0 repo and use it to create this environment. It is essentially a copy of the software versions in the file.</li>
</ul>
<p>Note: I sped up the gif below. The whole process may take a few minutes</p>
<p><img src="images/conda_create.gif" class="img-fluid"></p>
</section>
<section id="step-5-activate-the-environment" class="level4">
<h4 class="anchored" data-anchor-id="step-5-activate-the-environment">Step 5: Activate the environment</h4>
<p>You can switch between environments in the conda prompt or in a programming IDE (or both? idk). To activate and switch the env, write:</p>
<p><code>conda activate &lt;env_name&gt;</code></p>
<p>in this case</p>
<p><code>conda activate seq_env</code></p>
<p><img src="images/conda_activate.gif" class="img-fluid"></p>
<p><br></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The environment your in will show on the left of the prompt message. In this case it says <code>(seq_env)</code> instead of <code>(base)</code>. That way you know what env your working in</p>
</div>
</div>
</section>
</section>
<section id="install-new-packages" class="level3">
<h3 class="anchored" data-anchor-id="install-new-packages">install new packages</h3>
<p>Let’s say you want to add a new python package to the repo. I recommend doing this in an Anaconda prompt and then saving it over the environment.yml. Then you can push the new environment.yml with the new changes to github. Use these steps:</p>
<section id="step-1-install-a-new-package" class="level4">
<h4 class="anchored" data-anchor-id="step-1-install-a-new-package">Step 1: Install a new package</h4>
<p>Go to the Anaconda prompt, make sure you’re in the repo file path (<code>cd projects/sequencing_2.0</code>) and make sure you’re in the right conda env (<code>conda activate seq_env</code>).</p>
<p>Now, install the package. Usually packages can be installed with <code>pip install</code> or <code>conda install</code> or <code>conda install -c conda forge &lt;package&gt;</code>. This depends on the packages. Some need pip, others need conda. Google it to find out. Here i’m going to download a package from NCBI to demonstrate. The package is called <code>ncbi-datasets-cli</code>.</p>
<ul>
<li>This package uses <code>conda-forge</code> to install. Type in <code>conda install -c conda-forge ncbi-datasets-cli</code></li>
<li>It will give you a message Y/N to confirm. Type “y” and enter</li>
</ul>
<p><img src="images/add_pack.gif" class="img-fluid"></p>
</section>
<section id="step-2-save-the-package-to-the-repo" class="level4">
<h4 class="anchored" data-anchor-id="step-2-save-the-package-to-the-repo">Step 2: Save the package to the repo</h4>
<p>Now we need to save this package to the repo’s <code>environment.yml</code></p>
<ul>
<li>Type <code>conda env export &gt; environment.yml</code></li>
<li>Since the package is in your environment, this code is exporting your new environment to repo’s one.</li>
<li>Now push to github</li>
</ul>
<p><img src="images/add_yml.gif" class="img-fluid"></p>
</section>
</section>
</section>
<section id="renv" class="level2">
<h2 class="anchored" data-anchor-id="renv">renv</h2>
<p>For virtual environments in R, the package called <code>renv</code> is commonly used. It will save a list of packages to a lock file, similar to <code>environment.yml</code> or <code>requirements.txt</code>. Then, every time you or another teammate opens the R project in your repo the <code>renv</code> package will activate in the background and determine if any packages are not aligned with the repo’s lock file. <strong>It will ensure that everyone is using the same package versions</strong></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Your repo should have a <code>.Rproj</code> file at the <em>root</em> of the directory. If it doesn’t you can create it by opening <code>Rstudio &gt; File &gt; New Project... &gt; Existing Directory (or New Directory)</code> <strong>Make sure <code>.Rproj</code> files are NOT in your <code>.gitignore</code></strong></p>
</div>
</div>
<section id="create-a-renv" class="level3">
<h3 class="anchored" data-anchor-id="create-a-renv">create a renv</h3>
<section id="step-1---workspaces-1" class="level4">
<h4 class="anchored" data-anchor-id="step-1---workspaces-1">step 1 - workspaces</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Positron</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Rstudio</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Open Positron and you will see a screen like this</p>
<p><img src="images/positron_main.png" class="img-fluid"></p>
<p>Assuming you already have a project folder, click <code>Open Folder</code> and navigate to the <em>root</em> of the folder you want to work in.</p>
<p>Workspaces are like isolated projects. Each isolated project needs to have its own virtual environment so that we can avoid unwanted package issues seeping into multiple projects unknowingly.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<section id="step-1.1---projects" class="level6">
<h6 class="anchored" data-anchor-id="step-1.1---projects">step 1.1 - projects</h6>
<p>Open up Rstudio and in the upper right, click <code>Project: (None)</code> dropdown and select <code>New Project...</code></p>
<p><img src="images/rstudio_newproj.png" class="img-fluid"></p>
</section>
<section id="step-1.2---create-new-project" class="level6">
<h6 class="anchored" data-anchor-id="step-1.2---create-new-project">step 1.2 - create new project</h6>
<p>Now create a new project either in a new folder or an existing folder.</p>
<p><img src="images/rstudio_existing.png" class="img-fluid"></p>
<p>For existing directories, you can select the folder with Browse and select the R version</p>
<p><img src="images/rstudio_existing_new.png" class="img-fluid"></p>
<p>All of this will create a file called <code>&lt;your_project_name&gt;.Rproj</code>. And you should now be in that R project in Rstudio:</p>
<p><img src="images/rstudio_rproj.png" class="img-fluid"></p>
</section>
</div>
</div>
</div>
</section>
<section id="step-2---install-renv" class="level4">
<h4 class="anchored" data-anchor-id="step-2---install-renv">step 2 - install renv</h4>
<p>Now that we’re in the root of your repo directory, let’s initialize <code>renv</code>.</p>
<p>First install <code>renv</code>:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"renv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="step-3---initialize-renv" class="level4">
<h4 class="anchored" data-anchor-id="step-3---initialize-renv">step 3 - initialize renv</h4>
<p>In your console run this:</p>
<div class="smallframe">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">init</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><img src="images/renvinit.gif" class="img-fluid"></p>
<p><code>renv::init()</code> will:</p>
<ol type="1">
<li>Search through all R scripts in your repo and find all packages used</li>
<li>Create a snapshot of those packages</li>
<li>Save all packages in the repo in a new <code>renv</code> libraries path (similar to your C drive R libraries paths)</li>
<li>Create a <code>.gitignore</code> within the <code>renv</code> libraries path so that you don’t get spammed with thousands of libraries in your git commit</li>
<li>Create a lock file - this is like the <code>environment.yml</code> for conda. Think of it as instructions for which packages your repo is using</li>
<li>It also saved things like an <code>activate</code> R script which will activate that <code>renv</code> every time the repo is opened from the <code>.Rproj</code></li>
</ol>
</section>
<section id="step-4---activate-renv" class="level4">
<h4 class="anchored" data-anchor-id="step-4---activate-renv">step 4 - activate renv</h4>
<p>Restart your R session (Session &gt; Restart for Rstudio, or the Restart button in the console for Positron).</p>
<p>renv should now automatically activate whenever you are in the project/workspace.</p>
</section>
<section id="step-5---add-packages-1" class="level4">
<h4 class="anchored" data-anchor-id="step-5---add-packages-1">step 5 - add packages</h4>
<p>If you need to install a new package and want to put it in the repo, you will need to update the lock file. To do either of these:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">install</span>(<span class="st">"&lt;PACKAGE_NAME&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"&lt;PACKAGE_NAME"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="step-6---save-package-updates" class="level4">
<h4 class="anchored" data-anchor-id="step-6---save-package-updates">step 6 - save package updates</h4>
<p>Now if you can check your package updates into version control so that other collaborators can install the same packages with the same versions.</p>
<p>After you have the packages installed run</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>This will overwrite the lock file with the packages you added. Now you can push the <code>renv.lock</code> file to github and other collaborators can sync with your changes.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>There may be version dependency issues when installing a package and running a script. You may need to use <code>renv::history()</code> to see the previous hash of the lock file and use <code>renv::revert()</code> to revert the lock file back to its previous, stable state. More on this here https://solutions.posit.co/envs-pkgs/environments/upgrades/</p>
</div>
</div>
<p><img src="images/r_save.gif" class="img-fluid"></p>
<p>The video at the bottom of this page explains in detail <code>renv</code> and its capabilities https://solutions.posit.co/envs-pkgs/environments/upgrades/</p>
</section>
<section id="step-7---push-to-github" class="level4">
<h4 class="anchored" data-anchor-id="step-7---push-to-github">step 7 - push to GitHub</h4>
<p>Now look at your git status and you will see all the files <code>renv</code> created.</p>
<p>We have</p>
<ol type="1">
<li><code>.Rprofile</code> that contains an <code>renv activate.R</code> script - this will activate the repo’s <code>renv</code> every time the project is opened</li>
<li>The <code>renv.lock</code> file shows information on each package used in the repo and is used to update collaborator’s environments to match the lock file.</li>
<li><code>renv/.gitignore</code> I don’t feel like explaining this one right now - i’ll write more later</li>
<li><code>renv/activate.R</code> this will activate the env whenever the R project is opened</li>
<li><code>renv/settings.dcf</code> I have no clue what this is</li>
</ol>
<p><img src="images/renv_git.gif" class="img-fluid"></p>
</section>
<section id="troubleshooting" class="level4">
<h4 class="anchored" data-anchor-id="troubleshooting">troubleshooting</h4>
<p>If you already have an existing repo, you will probably see warnings and errors in the <code>renv::init()</code> like I did in the gif above. Not to worry! Read the warnings and follow the instructions. Usually you will need to re-install a package. If you get this warning:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>These may be left over from a prior, failed installation attempt.</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Consider removing or reinstalling these packages.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li>Then run this:</li>
</ul>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">install</span>(<span class="st">"&lt;PACKAGE_NAME&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li>It will install the package again,</li>
<li>and then you need to update the lock file (more on that later) by running <code>renv::snapshot()</code>.</li>
</ul>
<p>Now the package will be installed correctly</p>
<p><img src="images/renv_backports.gif" class="img-fluid"></p>
</section>
</section>
<section id="load-renv" class="level3">
<h3 class="anchored" data-anchor-id="load-renv">load renv</h3>
<section id="step-1---open-your-workspace" class="level4">
<h4 class="anchored" data-anchor-id="step-1---open-your-workspace">step 1 - open your workspace</h4>
<p>For Rstudio, open up the <code>.Rproj</code> file we created above, or the workspace in Positron</p>
<p><br></p>
<p>This will open up an R window with the repo file path as a root directory. It will also utilize the <code>renv</code>. Your console should say something about <code>renv</code>, like this</p>
<p><img src="images/image-664157118.png" class="img-fluid"></p>
</section>
<section id="step-2---restore-renv" class="level4">
<h4 class="anchored" data-anchor-id="step-2---restore-renv">step 2 - restore renv</h4>
<p>The first time you use <code>renv</code> you will need to configure it to your machine. To do this, run:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Console</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">restore</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>This will create a new environment for your R in your machine using the lock file packages.</p>
<p>Now you’re ready to use the scripts! Way less complicated than conda</p>
</section>
</section>
<section id="using-reticulate-python-with-renv" class="level3">
<h3 class="anchored" data-anchor-id="using-reticulate-python-with-renv">using reticulate (python) with renv</h3>
<p>Now that your R and Python environments are set up, if you have code that uses the <code>reticulate</code> package in R, it might still be pointing to your base Python environment. So, if you need to write python code in R (using reticulate), the code may break. Here’s what you need to do to make sure your <code>reticulate</code> python path is pointing towards your conda environment:</p>
<ol type="1">
<li>Open an anaconda prompt</li>
<li>Activate your env and then write <code>where python</code> and it will provide you with a python.exe for that particular env. Copy that path</li>
<li>Open the <code>.Rprofile</code> file in your repo and add this code: <code>Sys.setenv(RETICULATE_PYTHON = PATH_TO_ENV_PYTHON))</code>
<ul>
<li>Note, if you have other team members, make this code flexible to their usernames. It could look something like this <code>Sys.setenv(RETICULATE_PYTHON = file.path(Sys.getenv("USERPROFILE"),"Anaconda3/envs/seq_env/python.exe"))</code> where <code>Sys.getenv("USERPROFILE")</code> will add <code>C/Users/XXXX/</code> and it will automatically add the user’s name</li>
</ul></li>
<li>Now restart your R</li>
<li>Open back up R and <strong>without running any other code or loading any libraries</strong> run <code>reticulate::py_config()</code> in your console. This should now show your conda environment path being used for reticulate</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/NW-PaGe\.github\.io\/standards\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>🍦</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/NW-PaGe/standards/blob/main/gh/renv.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/NW-PaGe/standards/edit/main/gh/renv.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/NW-PaGe/standards/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>